<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Get a graph of the taxa in a dataset — get_taxon_graph • safedata</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Get a graph of the taxa in a dataset — get_taxon_graph" />
<meta property="og:description" content="This function loads the taxon index for a dataset (see
get_taxa) and creates a taxonomic graph for the dataset.
The graph vertex attributes contain further details of each taxon,
including GBIF id and taxonomic status." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">safedata</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/overview.html">An overview of data at the SAFE Project</a>
    </li>
    <li>
      <a href="../articles/using_safe_data.html">Using the `safedata` package</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ImperialCollegeLondon/safedata/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Get a graph of the taxa in a dataset</h1>
    <small class="dont-index">Source: <a href='https://github.com/ImperialCollegeLondon/safedata/blob/master/R/taxa.R'><code>R/taxa.R</code></a></small>
    <div class="hidden name"><code>get_taxon_graph.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function loads the taxon index for a dataset (see
<code>get_taxa</code>) and creates a taxonomic graph for the dataset.
The graph vertex attributes contain further details of each taxon,
including GBIF id and taxonomic status.</p>
    </div>

    <pre class="usage"><span class='fu'>get_taxon_graph</span>(<span class='no'>record</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>record</th>
      <td><p>A single dataset record id</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An <code><a href='https://rdrr.io/pkg/igraph/man/make_graph.html'>graph</a></code> object.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function may modify the taxon index data to represent it as a
graph, primarily to avoid duplicating taxon names, which are used as
the primary vertex id. Possible issues are:</p><ol>
<li><p>A user maps two worksheet names onto the _same_ taxon name: for
    example, "moth" and "butterfly" both using Lepidoptera as a taxon
    name. This is resolved by recreating the two worksheet names as
    children ofthe shared taxon name.</p></li>
<li><p>The taxon index may contain two GBIF taxonomic concepts with the
    same name (e.g. an accepted and doubtful usage). In this case, the
    function appends the GBIF ID to make taxon names unique.</p></li>
<li><p>Simple duplication of identical taxa - this should not happen
    but has been observed and the function removes all but one entry.</p></li>
<li><p>Missing parent taxa - again this should not happen but sometimes
    the GBIF backbone chain stops above the Kingdom level. The function
    adds a unique name for unknown parents.</p></li>
</ol>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>   <span class='fu'>set_example_safe_dir</span>()</div><div class='output co'>#&gt; <span class='message'>Validating directory</span></div><div class='input'>   <span class='no'>beetle_graph</span> <span class='kw'>&lt;-</span> <span class='fu'>get_taxon_graph</span>(<span class='fl'>1400562</span>)
   <span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>beetle_graph</span>, <span class='kw'>vertex.label.cex</span> <span class='kw'>=</span> <span class='fl'>0.6</span>, <span class='kw'>vertex.size</span> <span class='kw'>=</span> <span class='fl'>15</span>,
        <span class='kw'>vertex.size2</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>vertex.shape</span> <span class='kw'>=</span> <span class='st'>"rectangle"</span>)</div><div class='img'><img src='get_taxon_graph-1.png' alt='' width='700' height='433' /></div><div class='input'>   <span class='co'># show worksheet names for tips</span>
   <span class='no'>wsn</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>igraph</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/vertex_attr.html'>vertex_attr</a></span>(<span class='no'>beetle_graph</span>, <span class='st'>"worksheet_name"</span>)
   <span class='no'>txn</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>igraph</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/vertex_attr.html'>vertex_attr</a></span>(<span class='no'>beetle_graph</span>, <span class='st'>"name"</span>)
   <span class='no'>labels</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span>(<span class='no'>wsn</span>), <span class='no'>txn</span>, <span class='no'>wsn</span>)
   <span class='no'>is_leaf</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>igraph</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/vertex_attr.html'>vertex_attr</a></span>(<span class='no'>beetle_graph</span>, <span class='st'>"leaf"</span>)
   <span class='no'>vert_col</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='no'>is_leaf</span>, <span class='st'>"cornflowerblue"</span>, <span class='st'>"grey"</span>)
   <span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>beetle_graph</span>, <span class='kw'>vertex.label.cex</span> <span class='kw'>=</span> <span class='fl'>0.6</span>, <span class='kw'>vertex.size</span> <span class='kw'>=</span> <span class='fl'>15</span>,
        <span class='kw'>vertex.size2</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>vertex.shape</span> <span class='kw'>=</span> <span class='st'>"rectangle"</span>,
        <span class='kw'>vertex.label</span> <span class='kw'>=</span> <span class='no'>labels</span>, <span class='kw'>vertex.color</span><span class='kw'>=</span> <span class='no'>vert_col</span>)</div><div class='img'><img src='get_taxon_graph-2.png' alt='' width='700' height='433' /></div><div class='input'>   <span class='fu'>unset_example_safe_dir</span>()</div><div class='output co'>#&gt; <span class='message'>Validating directory</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Andy Aldersley, David Orme.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


